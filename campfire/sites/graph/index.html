<!doctype html>
<!--code made by gemini-->
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>データ表示 (UTC対応版)</title>
    
    <style>
      body {
        font-family: sans-serif;
        padding: 20px;
        line-height: 1.6;
      }
      .container {
        border: 1px solid #eee;
        padding: 15px;
        border-radius: 8px;
        background-color: #f9f9f9;
        display: inline-block;
      }
      .time-label { font-size: 0.9em; color: #666; }
      #utc-time { font-weight: bold; color: #d9534f; margin-bottom: 10px; }
      #ss-data { font-size: 20px; font-weight: bold; color: #0275d8; }
    </style>
  </head>
  <body>

    <div class="container">
      <div class="time-label">世界標準時刻 (UTC):</div>
      <div id="utc-time">読み込み中...</div>
      
      <div class="time-label">スプレッドシートデータ (M1414):</div>
      <div id="ss-data">読み込み中...</div>
    </div>

    <br><br>

    <iframe width="600" height="371" border="0" scrolling="no" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQOPyO9vkqXun7C6VzpZ1CVKBm2Cu-6AoETfRW3Pp7gB4iE0t-_jaXofZH_Yd6qdDzlsGqZFbz85_eX/pubchart?oid=626494851&amp;format=interactive"></iframe>

    <script>
      (function() {
        // 1. 世界標準時刻 (UTC) を表示する関数
        function updateUTCTime() {
          const now = new Date();
          // toISOString() や toUTCString() を使って世界標準時に変換します
          const utcString = now.toUTCString().replace("GMT", "UTC");
          document.getElementById("utc-time").innerText = utcString;
        }

        // 2. スプレッドシートのデータを取得する関数
        const url = "https://script.google.com/macros/s/AKfycbwwbfi0aUrDi__XbNgj8OltBUrAZWNfvHe0KUllqRM5yEE5S2dCexpVvA8VWSAAokr3/exec";
        
        async function fetchSheetData() {
          try {
            const response = await fetch(url);
            const data = await response.text();
            document.getElementById("ss-data").innerText = data;
          } catch (error) {
            document.getElementById("ss-data").innerText = "取得エラー";
          }
        }

        // 初回実行
        updateUTCTime();
        fetchSheetData();
        
        // 時刻を1秒ごとに更新したい場合は以下を有効にします
        setInterval(updateUTCTime, 1000);
      })();
    </script>

  </body>
</html>
