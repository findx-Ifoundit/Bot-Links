<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>Sheets API Data Display</title>
    <style>
      #ss-data {
        font-family: sans-serif;
        font-size: 18px;
        font-weight: bold;
        color: #333;
        display: inline-block;
        margin-bottom: 10px;
        min-height: 1.2em;
      }
    </style>
  </head>
  <body>

    <div id="ss-data">読み込み中...</div>

    <br>

    <iframe width="600" height="371" frameborder="0" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQOPyO9vkqXun7C6VzpZ1CVKBm2Cu-6AoETfRW3Pp7gB4iE0t-_jaXofZH_Yd6qdDzlsGqZFbz85_eX/pubchart?oid=626494851&amp;format=interactive"></iframe>

    <script>
      (function() {
        // --- 設定項目 ---
        const SPREADSHEET_ID = '2PACX-1vQOPyO9vkqXun7C6VzpZ1CVKBm2Cu-6AoETfRW3Pp7gB4iE0t-_jaXofZH_Yd6qdDzlsGqZFbz85_eX'; // 公開URLから取得したID
        const API_KEY = '1ebgK72Arbbu8l-BKPIQ0so19oNkNeab8658ejo7PI7s'; // ここに取得したAPIキーを入力
        const SHEET_NAME = '無題のスプレッドシート - シート1'; // 実際のシート名に変更してください
        const RANGE = 'M1414'; 
        // ----------------

        const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${SHEET_NAME}!${RANGE}?key=${API_KEY}`;
        const displayElement = document.getElementById("ss-data");

        async function fetchValue() {
          try {
            const response = await fetch(url);
            if (!response.ok) {
              const errorData = await response.json();
              throw new Error(errorData.error.message || 'API Error');
            }
            
            const data = await response.json();
            
            // values[行][列] の形式で届く。1セルの場合は [0][0]
            const text = (data.values && data.values[0]) ? data.values[0][0] : "データなし";
            
            displayElement.innerText = text;

          } catch (error) {
            console.error("API Fetch Error:", error);
            displayElement.innerText = "Error: " + error.message;
          }
        }

        fetchValue();
      })();
    </script>

  </body>
</html>
