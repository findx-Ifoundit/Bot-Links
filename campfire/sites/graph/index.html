<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8">
    <title>Sheet Data Display</title>
    <style>
      /* テキストの見た目：必要に応じて調整してください */
      #ss-data {
        font-family: sans-serif;
        font-size: 18px;
        font-weight: bold;
        color: #333;
        display: inline-block;
        padding: 5px;
        min-height: 1.2em;
      }
    </style>
  </head>
  <body>

    <div id="ss-data"></div>

    <br>

    <iframe width="600" height="371" frameborder="0" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vQOPyO9vkqXun7C6VzpZ1CVKBm2Cu-6AoETfRW3Pp7gB4iE0t-_jaXofZH_Yd6qdDzlsGqZFbz85_eX/pubchart?oid=626494851&amp;format=interactive"></iframe>

    <script>
      (function() {
        // 【注意】必ず「新バージョン」をデプロイした際の最新URLを貼り付けてください
        const url = "https://script.google.com/macros/s/AKfycbwwbfi0aUrDi__XbNgj8OltBUrAZWNfvHe0KUllqRM5yEE5S2dCexpVvA8VWSAAokr3/exec";
        const displayElement = document.getElementById("ss-data");

        async function loadData() {
          try {
            // リダイレクト(googleusercontents.com)を自動で追いかける設定
            const response = await fetch(url, {
              method: "GET",
              mode: "cors", // 外部サイトからのアクセスを明示
              redirect: "follow"
            });

            if (!response.ok) throw new Error('Network response was not ok');
            
            const text = await response.text();
            
            // 届いたデータを加工せず、そのまま1回パッと表示
            displayElement.innerText = text;

          } catch (error) {
            console.error("Fetch Error:", error);
            displayElement.innerText = "Error: データを読み込めませんでした";
          }
        }

        loadData();
      })();
    </script>

  </body>
</html>
